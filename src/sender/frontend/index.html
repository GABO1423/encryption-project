<html lang="en">
    <head>
        <meta charset="UTF-8">
        <title>Sender</title>
        <link rel="stylesheet" href="main.css">
        <link rel="icon" href="favicon.ico" type="image/x-icon">
    </head>
    <body>
        <div class="container">
            <div id="file-explorer"></div>
            <h2>Upload File</h2>
            <input type="file" id="localFile">
            <button onclick="uploadFile()">Upload</button>
            <p id="status-message"></p>
        </div>
        <script>
            const UPLOAD_URL = '/upload'; 
            const statusMessage = document.getElementById('status-message');

            function updateStatus(message, isError = false)
            {
                statusMessage.textContent = message;
                statusMessage.style.color = isError ? '#c62828' : '#2e7d32';
            }

            function uploadFile()
            {
                const fileInput = document.getElementById('localFile');
                updateStatus('Uploading...', false);

                if (!fileInput || fileInput.files.length === 0)
                {
                    updateStatus('Please select a file.', true);
                    console.error('No file selected.');
                    return;
                }

                const file = fileInput.files[0];
                const fileToSend = file;
                const formData = new FormData();

                formData.append('file', fileToSend, fileToSend.name); 
                console.log(`Uploading..: ${file.name} to ${UPLOAD_URL}`);
                
                fetch(UPLOAD_URL, {method: 'POST', body: formData}).then(response =>
                {
                    if (response.ok) return response.text();
                    throw new Error(`Error HTTP ${response.status}: ${response.statusText}`);
                })
                .then(data => 
                {
                    console.log('Upload success:', data);
                    updateStatus('Upload Successful! Data forwarded to receiver.', false);
                })
                .catch(error => 
                {
                    console.error(`Upload Error: ${error}`);
                    updateStatus(`Upload Failed: ${error.message || error}`, true);
                });
            }
        </script>
    </body>
</html>